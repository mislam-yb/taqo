-- FULL JOINS
-- WHERE SUBSELECT more that some value from subquery
SELECT *
FROM t1000000
         FULL JOIN t500000 ON t1000000.a = t500000.a
         FULL JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a < (SELECT MAX(a) from t50000)
ORDER BY t1000000.a
LIMIT 1000;

-- WHERE SUBSELECT less that some value from subquery
SELECT *
FROM t1000000
         FULL JOIN t500000 ON t1000000.a = t500000.a
         FULL JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a > (SELECT AVG(a) from t50000)
ORDER BY t1000000.a;

-- WHERE SUBSELECT in range of values
SELECT *
FROM t1000000
         FULL JOIN t500000 ON t1000000.a = t500000.a
         FULL join t50000 ON t1000000.a = t50000.a
WHERE t1000000.a in
      (SELECT t50000.a from t50000 where t50000.a < %(100))
ORDER BY t1000000.a
LIMIT 1000;

-- INNER JOINS
-- WHERE SUBSELECT more that some value from subquery
SELECT *
FROM t1000000
         INNER JOIN t500000 ON t1000000.a = t500000.a
         INNER JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a < (SELECT MAX(a) from t50000)
ORDER BY t1000000.a
LIMIT 1000;

-- WHERE SUBSELECT less that some value from subquery
SELECT *
FROM t1000000
         INNER JOIN t500000 ON t1000000.a = t500000.a
         INNER JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a > (SELECT AVG(a) from t50000)
ORDER BY t1000000.a;

-- WHERE SUBSELECT in range of values
SELECT *
FROM t1000000
         INNER JOIN t500000 ON t1000000.a = t500000.a
         INNER join t50000 ON t1000000.a = t50000.a
WHERE t1000000.a in
      (SELECT t50000.a from t50000 where t50000.a < %(100))
ORDER BY t1000000.a
LIMIT 1000;

-- LEFT JOINS
-- WHERE SUBSELECT more that some value from subquery
SELECT *
FROM t1000000
         LEFT OUTER JOIN t500000 ON t1000000.a = t500000.a
         LEFT OUTER JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a < (SELECT MAX(a) from t50000)
ORDER BY t1000000.a
LIMIT 1000;

-- WHERE SUBSELECT less that some value from subquery
SELECT *
FROM t1000000
         LEFT OUTER JOIN t500000 ON t1000000.a = t500000.a
         LEFT OUTER JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a > (SELECT AVG(a) from t50000)
ORDER BY t1000000.a;

-- WHERE SUBSELECT in range of values
SELECT *
FROM t1000000
         LEFT OUTER JOIN t500000 ON t1000000.a = t500000.a
         LEFT OUTER JOIN t50000 ON t1000000.a = t50000.a
WHERE t1000000.a in
      (SELECT t50000.a from t50000 where t50000.a < %(100))
ORDER BY t1000000.a
LIMIT 1000;